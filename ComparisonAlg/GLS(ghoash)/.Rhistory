}
res
##
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:20){
p = 15; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =3, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
#
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:20){
p = 30; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =3, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =5, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#####
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =5, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#####
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =5, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#####
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 15; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#####
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 15; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#####
###
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 25; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =9, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 25; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =3, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
##### Simulations for GDS ####
GDS_simulation_fun = function(seed, n_real, p_real ){
setwd("C:/Users/gwpar/Dropbox/GroupMeeting/2018GSEM/Rcode2/")
source("startups/startupGDS.R", chdir = TRUE)
###Gaussian SEM #############
# Gaussian, beta_jk = (-2,-0.25) \cup (0.25, 2) for Homo , and  (-2,-1) \cup (1, 2) for Hetero
#setwd("C:/2019GaussianSEM_SimulationResult/Data/Homo")
setwd("C:/2019GaussianSEM_SimulationResult/Data/Hetero")
p = 500;
#setwd("C:/2019GaussianSEM_SimulationResult/Data/NonFaithful");p=3
GaussianDAG_filename = paste0("GaussianSEM_p",p,"_seed",seed,".Rdata")
load(GaussianDAG_filename)
#########
synthetic.graph =DAGsamples
synthetic.graph$true_Matrix = synthetic.graph$true_Matrix[1:p_real, 1:p_real]
data = synthetic.graph$x[1:n_real,1:p_real]
data = as.matrix(data)
Runtime = proc.time()[3]
GDS_output = GDS(data, scoreName = "SEMSEV", pars = list(regr.pars = list()), check = "checkUntilFirstMinK", output = FALSE,startAt = "emptyGraph")$Adj
GDS_output = t(GDS_output)
Runtime = proc.time()[3] - Runtime
result_DAG = GDS_output
result_MEC = dag2cpdagAdj(result_DAG)
time_GDS = Runtime
#### Evaluation ####
B = synthetic.graph$true_Matrix
B[B!=0] =1
#A <- (B != result_DAG)
#rbind( rowSums(B), colSums(B),  rowSums(A), colSums(A),  rowSums(result_DAG), colSums(result_DAG) )
result_GDS_DAG = evaluation_fun( B, result_DAG )
result_GDS_MEC = evaluation_fun( dag2cpdagAdj(B), result_MEC )
# Return: 1.DAG, 2.MEC, 3.Oracle(known parents), 4.Estimated DAG, 5.Estimated Ordering, 6.Time
return(list( DAG_Evaluation = result_GDS_DAG,
MEC_Evaluation = result_GDS_MEC,
Oracle_Evaluation = NULL,
MEC = result_MEC,
Ordering = NULL ,
Time = time_GDS)
)
}
GDS
source("../inferDAG/initializeStateSEMSEV.R")
source("../inferDAG/computeScoreSEMSEV.R")
source("../inferDAG/computeNewStateSEMSEV.R")
source("../inferDAG/computeStatisticsFromDataSEMSEV.R")
source("../inferDAG/oneStepCheckingAll.R")
source("../inferDAG/oneStepCheckingUntilFirst.R")
source("../inferDAG/oneStepCheckingUntilFirstMinK.R")
source("../util_DAGs/computeScoreSEMGauss.R")
source("../util_DAGs/containsCycle.R")
source("../inferDAG/GDS.R")
#####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 25; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =3, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
#
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 50; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
##
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
##
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 10000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
###
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 10000;
beta_min = 0.50; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
###
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 10000;
beta_min = 0.20; beta_max = 1.00
graph_type = 1
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
#######
####
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 10; n = 10000;
beta_min = 0.20; beta_max = 1.00
graph_type = 5
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
######
##
res = matrix(0, nrow = 17, ncol =3)
for(i in 1:10){
p = 100; n = 1000;
beta_min = 0.20; beta_max = 1.00
graph_type = 1
noiseVar <- rep(1, p)
noiseVar <- runif(p, 1, 1)
raw = GSEM_generator( n, p, d =1, noiseVar, dist = "Gaussian", beta_min, beta_max, graph_type, structure = NULL, seed = sample(100,1))
data = raw$x
B = raw$true_Matrix
out = GSEM_Algorithm(data, alpha = 0.0001, direction ="forward", graph = B)
out2 = GSEM_Algorithm(data, alpha = 0.0001, direction ="backward", graph = B)
out3 = GBN_Algorithm(X = data, Sigma = cov(data) *(n-1)/n,
reg_param = 0.01,
inv_cov_threshold= 0.1,
use_marginal_variance_for_dag_order=FALSE, graph = B)
#get_dag_order(Sigma = solve(diag(p)-B) %*% diag(noiseVar) %*% solve(diag(p) -t(B)), O_hat = (diag(p) -t(B)) %*% diag(1/noiseVar) %*% (diag(p)-B), inv_cov_threshold= INV_COVARIANCE_THRESHOLD)
res = res + cbind(out[[1]], out2[[1]], out3[[1]])
rbind(out[[5]], out2[[5]], out3[[5]])
}
res
